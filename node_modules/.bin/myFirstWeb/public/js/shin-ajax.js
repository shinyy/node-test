$(function() {
    var jsonpagenum;
    function loadtable(pagenum) {
        $.ajax({
            type: "get",
            url: "js/j.json",
            async: true,
            dataType: "json",
            success: function(data) {
                var txt, x, xx, i, ii;
                txt = "<tr>";
                x = data.tr;
                console.log(x.length);
                //每页最多显示5条
                for (i = 0, ii = pagenum * 5; i < 5; i++) {
                    if (x[i + ii]) {

                        xx = x[i + ii].orderNum; {
                            try {
                                txt += "<td>"+xx+"</td>";
                            } catch(er) {
                                txt += "<td>&nbsp;</td>"
                            }
                        }

                        xx = x[i + ii].phone;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].user;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].hotel;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].roomtype;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].roomNum;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].intime;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].leavetime;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].ordertime;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].state;
                        txt += "<td>"+xx+"</td>";
                        xx = x[i + ii].tmorder;
                        txt += "<td>"+xx+"</td>";

                    }

                    txt += "</tr>";
                }
                $(".sTable tbody").html(txt);

                //分页
                console.log(Math.ceil(x.length / 5));
                jsonpagenum = Math.ceil(x.length / 5);
                $(".pagenum").children().remove();
                for (var j = 0; j < Math.ceil(x.length / 5); j++) {

                    $(".pagenum").append($('<span class="fg-button ui-button">' + (j + 1) + '</span>'))
                };
                $(".pagenum>span").eq(pagenum).addClass("ui-state-disabled")
            }
        });
    };
    loadtable(0);

    //上下页
    var clickNum = 0;
    $(".next.fg-button.ui-button").click(function() {
        if (clickNum < jsonpagenum - 1) {
            clickNum++;
            loadtable(clickNum);
        }

    });
    $(".previous.fg-button.ui-button").click(function() {
        if (clickNum > 0) {
            clickNum--;
            loadtable(clickNum);
        }

    });

    //点击页码
    $(".pagenum").on("click","span",function(){
        clickNum=$(this).index();
        loadtable(clickNum);
    });
    //首尾页
    $(".toFirst.ui-corner-tl.ui-corner-bl.fg-button.ui-button").click(function(){
        clickNum=0;
        loadtable(clickNum);
    });
    $(".last.ui-corner-tr.ui-corner-br.fg-button.ui-button").click(function(){
        clickNum=jsonpagenum-1;
        loadtable(clickNum);
    })

})